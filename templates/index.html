<!DOCTYPE html>
<html>
<head>
    <title>Financial Analyzer</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .metric-buttons { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
        .metric-button {
            padding: 10px 20px;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 5px;
            cursor: pointer;
        }
        .metric-button:hover { background-color: #e0e0e0; }
        .metric-button.active {
            background-color: #007bff;
            color: white;
            border-color: #0056b3;
        }
        #chart-container { margin-top: 20px; }
        .chart-frame {
            width: 100%;
            height: 600px;
            border: none;
            display: none;
        }
        .chart-frame.active { display: block; }
    </style>
</head>
<body>
<h1>Financial Analyzer</h1>
<div class="metric-buttons" id="metric-buttons"></div>
<div id="chart-container"></div>

<script>
    const metrics = {{.Metrics}};
    const container = document.getElementById('chart-container');
    const buttonsContainer = document.getElementById('metric-buttons');
    const charts = {};

    metrics.forEach((metric, index) => {
        const iframe = document.createElement('iframe');
        iframe.className = 'chart-frame';
        iframe.id = `chart-${metric}`;
        iframe.src = `/chart/${metric}`;
        container.appendChild(iframe);
        charts[metric] = iframe;

        const button = document.createElement('button');
        button.className = 'metric-button' + (index === 0 ? ' active' : '');
        button.textContent = formatMetricName(metric);
        button.onclick = (function(m) {
            return function() {
                showChart(m);
            };
        })(metric);
        buttonsContainer.appendChild(button);
    });

    function showChart(metric) {
        document.querySelectorAll('.chart-frame').forEach(iframe => {
            iframe.classList.remove('active');
        });
        document.querySelectorAll('.metric-button').forEach(btn => {
            btn.classList.remove('active');
        });

        document.getElementById(`chart-${metric}`).classList.add('active');

        const activeButton = Array.from(document.querySelectorAll('.metric-button')).find(
            btn => btn.textContent === formatMetricName(metric)
        );
        if (activeButton) {
            activeButton.classList.add('active');
        }
    }

    function formatMetricName(metric) {
        const names = {
            'revenue': 'Revenue',
            'net_profit': 'Net Profit',
            'ebitda': 'EBITDA',
            'pe': 'P/E Ratio',
            'roe': 'ROE (%)',
            'capitalization': 'Market Cap',
            'debt': 'Debt'
        };
        return names[metric] || metric;
    }

    if (metrics.length > 0) {
        showChart(metrics[0]);
    }
</script>
</body>
</html>